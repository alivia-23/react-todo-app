(this["webpackJsonpreact-todo"]=this["webpackJsonpreact-todo"]||[]).push([[0],[,,,,,,function(e,t,n){e.exports=n.p+"static/media/Human-go-down.bc058c7d.svg"},function(e,t,n){e.exports=n.p+"static/media/Human-go-up.705e49c4.svg"},,,function(e,t,n){e.exports=n.p+"static/media/spinner.414a23f5.svg"},function(e,t,n){e.exports=n(18)},,,,,function(e,t,n){},function(e,t,n){},function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),c=n(9),r=n.n(c),s=(n(16),n(2)),u=n(3),i=n(1),l=function(e){return{message:"NETWORK-ERROR",err:e}},m=function(e){return Promise.reject(e)},d=function(e){return fetch("/tasks/".concat(e),{method:"GET"}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)}))},h=function(e,t,n){return fetch("/tasks/".concat(e,"/").concat(t),{method:"PUT",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({task:n})}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)}))},f={DEFAULT:"Oh no!  Something went wrong, please try again",USERNAME_REQUIRED:"Username is required",NETWORK_ERROR:"There was a problem reaching your network, please try again",LOGIN_REQUIRED:"You must be logged in to view this content",LOGIN_UNAUTHORIZED:"You are not permitted to view this content",EMPTY_TASKNAME:"Taskname cannot be empty","login denied":"Username must be between 2-20 chracters and start with [A-Za-z0-9_-]","no valid session":"Your session is not valid","action not permitted":"This action is not permitted","no tasks for user":"There is no such task","no such taskId":"Invalid taskId","failed to update":"Update failed"},E=(n(17),n(10)),b=n.n(E),p=function(e){var t=e.onLogin,n=Object(a.useState)(""),c=Object(i.a)(n,2),r=c[0],s=c[1],u=Object(a.useState)(!1),d=Object(i.a)(u,2),h=d[0],E=d[1],p=Object(a.useState)(""),g=Object(i.a)(p,2),v=g[0],j=g[1];return o.a.createElement("div",{className:"login"},o.a.createElement("p",{className:"error"},v),o.a.createElement("div",null,o.a.createElement("input",{onChange:function(e){return s(e.target.value)}}),h?o.a.createElement("img",{alt:"spinner",src:b.a}):o.a.createElement("button",{onClick:function(){r&&""!==r.trim()?(j(""),E(!0),function(e){return fetch("/session",{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({username:e})}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)}))}(r).then((function(e){j(""),t(e.data)})).catch((function(e){j(f[e.message||"DEFAULT"]),E(!1)}))):j(f["login denied"])}},"Login")))},g=o.a.createContext({default:"To be overriden"}),v=function(e){var t=e.user,n=e.onLogout,c=Object(a.useContext)(g),r=c.theme,s=c.themes,u=(c.refreshTheme,s[r].buttonStyle);return o.a.createElement("div",{className:"logout"},o.a.createElement("span",{className:"user-name"}," ",t.username," "),o.a.createElement("span",null," ",o.a.createElement("button",{className:u,onClick:function(){fetch("/session",{method:"DELETE"}).catch(l).then((function(e){return e.ok})).then((function(){return n()})).catch((function(e){}))}}," Logout ")))},j=n(6),k=n.n(j),O=n(7),N=n.n(O);var y=function(e,t){switch(t.type){case"sortByNameAsc":return Object(s.a)(e).sort((function(e,t){return e.taskName.toUpperCase()<=t.taskName.toUpperCase()?-1:1}));case"sortByNameDesc":return Object(s.a)(e).sort((function(e,t){return e.taskName.toUpperCase()>t.taskName.toUpperCase()?-1:1}));case"sortByNotDoneFirst":return Object(s.a)(e).sort((function(e,t){return e.done===t.done?0:e.done?1:-1}));case"sortByDoneFirst":return Object(s.a)(e).sort((function(e,t){return e.done===t.done?0:e.done?-1:1}));case"refreshOriginalTodos":d(t.username).then((function(e){return Object.values(e.data)})).catch((function(e){}));case"filterOutDone":return Object(s.a)(e).filter((function(e){return!e.done}));default:return e}},T=function(e){var t,n=e.user,c=e.todos,r=e.todo,d=e.index,E=e.refreshTodos,b=e.onError,p=Object(a.useContext)(g),v=p.theme,j=p.themes,k=(p.refreshTheme,j[v].buttonStyle),O=Object(a.useState)(!1),N=Object(i.a)(O,2),y=N[0],T=N[1],S=Object(a.useState)(""),C=Object(i.a)(S,2),A=C[0],L=C[1],w=Object(a.useState)(r.taskName),D=Object(i.a)(w,2),I=D[0],U=D[1],x=Object(a.useState)(r.taskName),F=Object(i.a)(x,2),R=F[0],B=F[1],P=function(e){(function(e,t){return fetch("/tasks/".concat(e,"/").concat(t),{method:"DELETE"}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)}))})(n.username,e).then((function(e){var t=e.data,n=c.filter((function(e){return e.taskId!==t.taskId}));E(Object(s.a)(n))})).catch((function(e){b(f[e.message||"DEFAULT"])}))},M=function(e){return c.filter((function(t){return t.taskId===e}))[0]};return t=y?o.a.createElement(o.a.Fragment,null,o.a.createElement("span",null,o.a.createElement("input",{type:"text",className:"todo-name",value:I,onChange:function(e){return U(e.target.value)}})),o.a.createElement("span",null,o.a.createElement("button",{className:k,onClick:function(){return function(e){var t=M(e),a=Object(u.a)({},t,{taskName:I});I&&""!==I.trim()?(L(""),h(n.username,e,a).then((function(e){T(!1);var t=e.data;c[d]=t,E(Object(s.a)(c))})).catch((function(e){b(f[e.message||"DEFAULT"])}))):L(f.EMPTY_TASKNAME)}(r.taskId)}},"Save")),o.a.createElement("span",null,o.a.createElement("button",{className:k,onClick:function(){return T(!1),U(R),void L("")}},"Cancel"))):o.a.createElement(o.a.Fragment,null,o.a.createElement("span",{className:r.done?"todo-name-complete":"todo-name"}," ",r.taskName," "),o.a.createElement("span",null,o.a.createElement("button",{className:k,onClick:function(){return T(!0),void B(I)}},"Edit")," ")),o.a.createElement("li",{key:r.taskId,className:"todo-row"},o.a.createElement("div",{className:"edit-error"},A),o.a.createElement("div",{className:"todo"},o.a.createElement("span",null,o.a.createElement("input",{className:"todo-done",type:"checkbox",checked:r.done,onChange:function(e){return function(e,t){var a=M(e),o=Object(u.a)({},a,{done:!a.done});h(n.username,e,o).then((function(e){var n=e.data;c[t]=n,E(Object(s.a)(c))})).catch((function(e){b(f[e.message||"DEFAULT"])}))}(r.taskId,d)}})),t,o.a.createElement("span",null,o.a.createElement("button",{className:"delete-todo",onClick:function(e){return P(r.taskId)}},"X")," ")))},S=function(e){var t=e.user,n=e.todos,c=e.refreshTodos,r=e.onError,s=Object(a.useState)(""),u=Object(i.a)(s,2),l=(u[0],u[1],Object(a.useState)(!1)),m=Object(i.a)(l,2),h=m[0],E=m[1],b=Object(a.useContext)(g),p=b.theme,v=b.themes,j=(b.refreshTheme,v[p].buttonStyle),O=function(){d(t.username).then((function(e){c(Object.values(e.data))})).catch((function(e){r(f[e.message])}))};return o.a.createElement("div",{className:"todo-content"},o.a.createElement("div",null,o.a.createElement("span",null,o.a.createElement("button",{className:j,onClick:function(e){return O()}},"Refresh"))),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("span",null,"Filter out completed tasks",o.a.createElement("input",{className:"filter-todos",type:"checkbox",onChange:function(e){return function(e){if(e){var t=y(n,{type:"filterOutDone"});E(!0),c(t)}else E(!1),O()}(e.target.checked)}}))),o.a.createElement("br",null),o.a.createElement("div",null,o.a.createElement("div",{className:"todo-done-header"},o.a.createElement("div",null,o.a.createElement("span",null,"Done"),o.a.createElement("span",null,o.a.createElement("img",{className:"asc-sort-icon",alt:"asc-sort-icon",src:N.a,onClick:function(){var e=y(n,{type:"sortByNotDoneFirst"});c(e)}})),o.a.createElement("span",null,o.a.createElement("img",{className:"desc-sort-icon",alt:"desc-sort-icon",src:k.a,onClick:function(){var e=y(n,{type:"sortByDoneFirst"});c(e)}})))),o.a.createElement("div",{className:"todo-name-header"},o.a.createElement("div",null,o.a.createElement("span",null,"Name"),o.a.createElement("span",null,o.a.createElement("img",{className:"asc-sort-icon",alt:"asc-sort-icon",src:N.a,onClick:function(){var e=y(n,{type:"sortByNameAsc"});c(e)}})),o.a.createElement("span",null,o.a.createElement("img",{className:"desc-sort-icon",alt:"desc-sort-icon",src:k.a,onClick:function(){var e=y(n,{type:"sortByNameDesc"});c(e)}}))))),o.a.createElement("ul",{className:"todos"},n.map((function(e,a){return h&&!e.done||!h?o.a.createElement(T,{key:e.taskId,user:t,todos:n,todo:e,index:a,refreshTodos:c,onError:r}):""}))))},C=function(e){var t=e.user,n=e.onAddSuccess,c=e.onAddError,r=Object(a.useContext)(g),s=r.theme,u=r.themes,d=(r.refreshTheme,u[s].buttonStyle),h=Object(a.useState)(""),E=Object(i.a)(h,2),b=E[0],p=E[1],v=function(e){var a,o;e&&""!==e.trim()?(a=t.username,o=e,fetch("/tasks/".concat(a),{method:"POST",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({task:{taskName:o,done:!1}})}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)}))).then((function(e){p(""),n(e.data)})).catch((function(e){c(f[e.message||"DEFAULT"])})):c(f.EMPTY_TASKNAME)};return o.a.createElement("div",{className:"add-message"},o.a.createElement("input",{className:"to-add",type:"text",value:b,placeholder:"Enter your text",onChange:function(e){return p(e.target.value)}}),o.a.createElement("button",{className:d,onClick:function(){return v(b)}},"Add"))},A=function(){return o.a.createElement("div",{className:"app-title"},o.a.createElement("h1",null," Todo App "))},L=function(e){var t=e.user,n=e.onError,c=Object(a.useContext)(g),r=(c.theme,c.refreshTheme),s=function(e){(function(e,t){return fetch("/theme/".concat(e),{method:"PUT",headers:new Headers({"content-type":"application/json"}),body:JSON.stringify({theme:t})}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)}))})(t.username,e).then((function(){r(e)})).catch((function(e){n(f[e.message||"DEFAULT"])}))};return o.a.createElement("div",{className:"themes"},"Theme:",o.a.createElement("select",{className:"themes-select",value:t.theme,onChange:function(e){return s(e.target.value)}},o.a.createElement("option",{value:"light"},"light"),o.a.createElement("option",{value:"dark"},"dark"),o.a.createElement("option",{value:"colorful"},"colorful")))};var w=function(){var e=Object(a.useState)({isLoggedIn:!1,theme:"light"}),t=Object(i.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)([]),h=Object(i.a)(r,2),E=(h[0],h[1],Object(a.useState)([])),b=Object(i.a)(E,2),j=b[0],k=b[1],O=Object(a.useState)(""),N=Object(i.a)(O,2),y=N[0],T=N[1],w={light:{buttonStyle:"light-theme-button",bodyBackground:"#fff7e6"},dark:{buttonStyle:"dark-theme-button",bodyBackground:"#C0C0C0"},colorful:{buttonStyle:"colorful-theme-button",bodyBackground:"#78428a"}},D=function(e){return Object.keys(w).includes(e)?e:"light"};Object(a.useEffect)((function(){fetch("/session",{method:"GET"}).catch(l).then((function(e){return e.ok?e.json():e.json().then(m)})).then((function(e){var t=e.data;c(Object(u.a)({},t,{isLoggedIn:!0,theme:D(t.theme)})),x(t.theme),T("")})).catch((function(e){T(f[e.message||"DEFAULT"])}))}),[]),Object(a.useEffect)((function(){n.isLoggedIn&&d(n.username).then((function(e){k(Object.values(e.data)),T("")})).catch((function(e){T(f[e.message||"DEFAULT"])}))}),[n]);var I,U=function(e){T(e)},x=function(e){document.body.style.backgroundColor=w[e].bodyBackground};return I=n.isLoggedIn?o.a.createElement("div",null,o.a.createElement(L,{user:n,onError:U}),o.a.createElement(v,{user:n,onLogout:function(){c({isLoggedIn:!1,theme:"light"}),x("light"),T("")}}),o.a.createElement("div",{className:"error"},y),o.a.createElement(C,{user:n,onAddSuccess:function(e){k([].concat(Object(s.a)(j),[e])),T("")},onAddError:U}),o.a.createElement(S,{user:n,todos:j,refreshTodos:function(e){k(e),T("")},onError:U})):o.a.createElement(p,{onLogin:function(e){c(Object(u.a)({},e,{isLoggedIn:!0,theme:D(e.theme)})),x(e.theme),T("")}}),o.a.createElement("div",{className:"app"},o.a.createElement(g.Provider,{value:{theme:n.theme,themes:w,refreshTheme:function(e){c(Object(u.a)({},n,{theme:e})),x(e)}}},o.a.createElement(A,null),I))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(w,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}],[[11,1,2]]]);
//# sourceMappingURL=main.1be366f8.chunk.js.map